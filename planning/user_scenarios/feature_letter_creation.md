# 유저 시나리오: 음악 편지 생성

**기능**: 2.2 음악 편지 생성  
**작성자**: Athena PM  
**작성 일시**: 2024년  
**우선순위**: P0

---

## 시나리오 1: 기본 편지 생성 (곡 검색 및 추가)

### Given (전제 조건)
- 사용자가 로그인되어 있음
- 사용자가 메인 화면에 있음
- 사용자는 친구에게 생일 선물로 음악 편지를 보내고 싶어함

### When (행동)
1. 사용자가 "편지 만들기" 버튼을 클릭함
2. 곡 검색창에 곡 제목 또는 아티스트명을 입력함 (예: "Happy Birthday")
3. 검색 결과가 표시됨 (제목, 아티스트, 앨범 커버)
4. 사용자가 원하는 곡을 선택하여 플레이리스트에 추가함
5. 최소 1곡 이상 추가함
6. 메시지를 작성함 (최대 500자)
7. "미리보기" 버튼을 클릭하여 편지 미리보기를 확인함
8. "편지 완성" 버튼을 클릭함

### Then (기대 결과)
- 편지가 생성됨
- 편지 전송 화면으로 이동함
- 생성된 편지가 카드 형태로 표시됨
- 모바일/데스크톱에서 반응형으로 표시됨

### 성공 기준
- 편지 생성 완료까지 3분 이내
- 사용자 만족도 4.0/5.0 이상

---

## 시나리오 2: AI 메시지 생성 사용

### Given (전제 조건)
- 사용자가 편지 생성 화면에 있음
- 사용자가 곡을 최소 1곡 이상 추가함
- 사용자는 메시지 작성에 어려움을 느끼고 있음

### When (행동)
1. 사용자가 "AI로 메시지 생성" 버튼을 클릭함
2. 상황 선택 (생일/위로/축하/사랑/우정)
3. AI가 메시지를 생성함
4. 사용자가 생성된 메시지를 확인함
5. 사용자가 메시지를 수정함 (선택적)
6. "적용" 버튼을 클릭함

### Then (기대 결과)
- AI가 생성한 메시지가 입력 필드에 표시됨
- 사용자가 메시지를 수정할 수 있음
- 메시지가 편지에 적용됨

---

## 시나리오 3: 곡에 메모 추가

### Given (전제 조건)
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 곡을 추가함

### When (행동)
1. 사용자가 플레이리스트의 특정 곡 옆 "메모 추가" 버튼을 클릭함
2. 메모 입력창에 메시지를 입력함 (최대 100자)
3. "저장" 버튼을 클릭함

### Then (기대 결과)
- 곡에 메모가 추가됨
- 메모가 편지 미리보기에 표시됨
- 수신자가 각 곡의 메모를 확인할 수 있음

---

## 시나리오 4: 곡 순서 변경 (드래그 앤 드롭)

### Given (전제 조건)
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 여러 곡을 추가함

### When (행동)
1. 사용자가 특정 곡을 드래그함
2. 원하는 위치로 드롭함

### Then (기대 결과)
- 곡의 순서가 변경됨
- 변경된 순서가 즉시 반영됨
- 변경된 순서가 편지 미리보기에 표시됨

---

## 시나리오 5: 곡 삭제

### Given (전제 조건)
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 여러 곡을 추가함

### When (행동)
1. 사용자가 특정 곡 옆 "삭제" 버튼을 클릭함
2. 삭제 확인 메시지에서 "확인"을 클릭함

### Then (기대 결과)
- 곡이 플레이리스트에서 제거됨
- 플레이리스트가 업데이트됨
- 최소 1곡이 남아있어야 함 (마지막 곡은 삭제 불가)

---

## 엣지 케이스

### 엣지 케이스 1: 검색 결과 없음
**Given**: 사용자가 곡을 검색함  
**When**: 검색 결과가 없음  
**Then**: 
- "검색 결과가 없습니다" 메시지가 표시됨
- 다른 검색어를 입력하도록 안내됨

### 엣지 케이스 2: 메시지 글자 수 초과
**Given**: 사용자가 메시지를 작성함  
**When**: 메시지가 500자를 초과함  
**Then**: 
- 입력이 차단됨
- "최대 500자까지 입력 가능합니다" 메시지가 표시됨
- 글자 수 카운터가 빨간색으로 표시됨

### 엣지 케이스 3: 곡 없이 편지 생성 시도
**Given**: 사용자가 편지 생성 화면에 있음  
**When**: 곡을 추가하지 않고 "편지 완성" 버튼을 클릭함  
**Then**: 
- "최소 1곡 이상 추가해주세요" 에러 메시지가 표시됨
- 곡 검색 영역으로 스크롤됨

### 엣지 케이스 4: 네트워크 오류로 검색 실패
**Given**: 사용자가 곡을 검색함  
**When**: 네트워크 오류가 발생함  
**Then**: 
- "연결에 실패했습니다. 다시 시도해주세요" 메시지가 표시됨
- 재시도 버튼이 제공됨

### 엣지 케이스 5: AI 메시지 생성 실패
**Given**: 사용자가 AI 메시지 생성을 요청함  
**When**: AI API 호출이 실패함  
**Then**: 
- "메시지 생성에 실패했습니다" 메시지가 표시됨
- 직접 메시지를 작성할 수 있도록 안내됨

---

## 사용자 변화

**Before**: 음악을 단순 링크로 공유, 맥락 없음  
**After**: 메시지와 함께 음악을 "선물"로 인식, 감성적 가치 부여  
**변화 지표**: 편지 생성 완료 시간 3분 이내, 사용자 만족도 4.0/5.0 이상

---

## 레버리지 포인트 활용

- 플랫폼 중립성의 핵심 구현: 어떤 플랫폼의 곡이든 검색 가능
- 플레이리스트 활동 기록으로 신뢰 시스템 기반 구축

