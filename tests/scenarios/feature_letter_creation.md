# 테스트 시나리오: 음악 편지 생성

**기능**: 2.2 음악 편지 생성  
**작성자**: Taylor FE TEST  
**작성 일시**: 2024년  
**기반**: `user_scenarios/feature_letter_creation.md`

---

## 테스트 목표

음악 편지 생성 기능의 모든 유저 시나리오를 검증하여 다음을 확인:
- 곡 검색 및 추가 기능 정상 동작
- 메시지 작성 및 AI 메시지 생성 정상 동작
- 편지 미리보기 정상 동작
- 모든 엣지 케이스 적절히 처리

---

## 테스트 케이스

### TC-LETTER-001: 기본 편지 생성 (곡 검색 및 추가)

**시나리오**: 사용자가 곡을 검색하고 추가하여 편지를 생성함

**Given**:
- 사용자가 로그인되어 있음
- 사용자가 메인 화면에 있음

**When**:
1. "편지 만들기" 버튼 클릭
2. 곡 검색창에 "Happy Birthday" 입력
3. 검색 결과에서 곡 선택
4. 곡을 플레이리스트에 추가
5. 메시지 입력 (예: "생일 축하해!")
6. "미리보기" 버튼 클릭
7. "편지 완성" 버튼 클릭

**Then**:
- 편지가 생성됨
- 편지 전송 화면으로 이동
- 생성된 편지가 카드 형태로 표시됨

**검증 포인트**:
- 곡 검색 API 정상 동작
- 플레이리스트에 곡 추가 정상
- 편지 생성 완료 시간 3분 이내

---

### TC-LETTER-002: AI 메시지 생성 사용

**시나리오**: 사용자가 AI 메시지 생성을 사용함

**Given**:
- 사용자가 편지 생성 화면에 있음
- 사용자가 곡을 최소 1곡 이상 추가함

**When**:
1. "AI로 메시지 생성" 버튼 클릭
2. 상황 선택 (생일)
3. AI가 메시지 생성
4. 생성된 메시지 확인
5. 메시지 수정 (선택적)
6. "적용" 버튼 클릭

**Then**:
- AI가 생성한 메시지가 입력 필드에 표시됨
- 사용자가 메시지를 수정할 수 있음
- 메시지가 편지에 적용됨

**검증 포인트**:
- OpenAI API 호출 정상
- 생성된 메시지 품질 확인
- 메시지 수정 기능 정상

---

### TC-LETTER-003: 곡에 메모 추가

**시나리오**: 사용자가 특정 곡에 메모를 추가함

**Given**:
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 곡을 추가함

**When**:
1. 특정 곡 옆 "메모 추가" 버튼 클릭
2. 메모 입력 (예: "이 곡이 가장 좋아하는 곡이야")
3. "저장" 버튼 클릭

**Then**:
- 곡에 메모가 추가됨
- 메모가 편지 미리보기에 표시됨

**검증 포인트**:
- 메모 저장 정상
- 메모 최대 100자 제한 확인

---

### TC-LETTER-004: 곡 순서 변경 (드래그 앤 드롭)

**시나리오**: 사용자가 곡의 순서를 변경함

**Given**:
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 여러 곡을 추가함

**When**:
1. 특정 곡을 드래그함
2. 원하는 위치로 드롭함

**Then**:
- 곡의 순서가 변경됨
- 변경된 순서가 즉시 반영됨
- 변경된 순서가 편지 미리보기에 표시됨

**검증 포인트**:
- 드래그 앤 드롭 기능 정상
- 순서 변경 저장 정상

---

### TC-LETTER-005: 곡 삭제

**시나리오**: 사용자가 플레이리스트에서 곡을 삭제함

**Given**:
- 사용자가 편지 생성 화면에 있음
- 사용자가 플레이리스트에 여러 곡을 추가함

**When**:
1. 특정 곡 옆 "삭제" 버튼 클릭
2. 삭제 확인 메시지에서 "확인" 클릭

**Then**:
- 곡이 플레이리스트에서 제거됨
- 플레이리스트가 업데이트됨
- 최소 1곡이 남아있어야 함

**검증 포인트**:
- 곡 삭제 정상
- 마지막 곡 삭제 방지

---

## 엣지 케이스 테스트

### TC-LETTER-E001: 검색 결과 없음

**시나리오**: 검색어에 대한 결과가 없음

**Given**: 사용자가 곡을 검색함

**When**: 검색 결과가 없음

**Then**:
- "검색 결과가 없습니다" 메시지 표시
- 다른 검색어를 입력하도록 안내

**검증 포인트**:
- 빈 결과 처리 정상
- 사용자 피드백 명확

---

### TC-LETTER-E002: 메시지 글자 수 초과

**시나리오**: 메시지가 500자를 초과함

**Given**: 사용자가 메시지를 작성함

**When**: 메시지가 500자를 초과함

**Then**:
- 입력이 차단됨
- "최대 500자까지 입력 가능합니다" 메시지 표시
- 글자 수 카운터가 빨간색으로 표시

**검증 포인트**:
- 글자 수 제한 정상 동작
- 실시간 글자 수 카운팅

---

### TC-LETTER-E003: 곡 없이 편지 생성 시도

**시나리오**: 곡을 추가하지 않고 편지 생성 시도

**Given**: 사용자가 편지 생성 화면에 있음

**When**: 곡을 추가하지 않고 "편지 완성" 버튼 클릭

**Then**:
- "최소 1곡 이상 추가해주세요" 에러 메시지 표시
- 곡 검색 영역으로 스크롤

**검증 포인트**:
- 필수 항목 검증 정상
- 사용자 가이드 제공

---

### TC-LETTER-E004: 네트워크 오류로 검색 실패

**시나리오**: 곡 검색 중 네트워크 오류 발생

**Given**: 사용자가 곡을 검색함

**When**: 네트워크 오류가 발생함

**Then**:
- "연결에 실패했습니다. 다시 시도해주세요" 메시지 표시
- 재시도 버튼 제공

**검증 포인트**:
- 에러 핸들링 정상
- 재시도 기능 제공

---

### TC-LETTER-E005: AI 메시지 생성 실패

**시나리오**: AI 메시지 생성 중 API 호출 실패

**Given**: 사용자가 AI 메시지 생성을 요청함

**When**: AI API 호출이 실패함

**Then**:
- "메시지 생성에 실패했습니다" 메시지 표시
- 직접 메시지를 작성할 수 있도록 안내

**검증 포인트**:
- API 실패 처리 정상
- 대안 제공

---

## 테스트 커버리지 목표

- **단위 테스트**: 80% 이상
- **통합 테스트**: 주요 플로우 100%
- **엣지 케이스**: 모든 엣지 케이스 테스트

---

## 테스트 우선순위

- **P0 (필수)**: TC-LETTER-001, TC-LETTER-E003
- **P1 (중요)**: TC-LETTER-002, TC-LETTER-003, TC-LETTER-004, TC-LETTER-005, TC-LETTER-E001, TC-LETTER-E002, TC-LETTER-E004, TC-LETTER-E005

---

## 다음 단계

1. 단위 테스트 작성 (RED)
2. 통합 테스트 작성
3. E2E 테스트 작성

