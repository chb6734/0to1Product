# QA-PM-FE Engineer 협업: E2E 테스트 버그 수정

**참여자**: Quinn QA, Athena PM, Sam FE Engineer  
**일시**: 2024년  
**목적**: E2E 테스트에서 발견된 온보딩 페이지 접근 문제 해결

---

## 🔍 QA: 버그 발견 및 리포트

**Quinn QA**: E2E 테스트를 실행한 결과, 온보딩 페이지로 직접 접근할 수 없는 문제를 발견했습니다.

**문제점**:
- `/onboarding` 페이지로 직접 이동 시 `/login`으로 리다이렉트됨
- `useAuth` 훅이 localStorage에서 상태를 복원하는데 시간이 걸려서, `isAuthenticated`가 `false`로 판단됨
- E2E 테스트에서 Mock 인증 상태를 설정해도 리다이렉트가 먼저 발생

**영향받는 테스트**:
1. `TC-AUTH-E003: 닉네임 미입력 검증` ❌
2. `온보딩 페이지 UI 요소 확인` ❌

**버그 리포트**: `qa/reports/bug_reports_e2e_1.md`에 상세 내용 기록

---

## 🧭 PM: 우선순위 및 요구사항 확인

**Athena PM**: 이해했습니다. 이 문제는 E2E 테스트의 테스트 가능성을 저해하는 중요한 이슈입니다.

**요구사항**:
1. E2E 테스트에서 온보딩 페이지에 접근할 수 있어야 함
2. 실제 사용자 플로우는 유지되어야 함 (OAuth 콜백 후 온보딩 페이지로 이동)
3. 테스트 환경과 실제 환경 모두에서 정상 동작해야 함

**우선순위**: High (E2E 테스트 완료를 위해 필수)

---

## 💻 FE Engineer: 문제 분석 및 해결 방안

**Sam FE Engineer**: 문제를 확인했습니다. `useAuth` 훅의 세션 확인 로직과 온보딩 페이지의 리다이렉트 로직을 개선하겠습니다.

**해결 방안**:
1. **`useAuth` 훅 개선**: 세션 확인 로직을 비동기로 처리하고, 초기 로딩 상태 추가
2. **온보딩 페이지 개선**: 인증 상태 확인 전에 로딩 상태 표시
3. **E2E 테스트 헬퍼 개선**: Mock 인증 상태를 더 확실하게 설정

**구현 계획**:
1. `useAuth` 훅에 `isInitializing` 상태 추가
2. 온보딩 페이지에서 `isInitializing` 상태 확인
3. E2E 테스트 헬퍼에서 localStorage 설정 개선

---

## 🔧 FE Engineer: 구현 시작

**Sam FE Engineer**: 수정을 시작하겠습니다.

**변경 사항**:
1. `src/domains/auth/hooks/useAuth.ts`: 초기화 상태 추가
2. `src/app/(auth)/onboarding/page.tsx`: 초기화 상태 확인 로직 추가
3. `tests/e2e/helpers/msw.ts`: Mock 인증 상태 설정 개선

---

## 🔍 QA: 재테스트 및 검증

**Quinn QA**: 수정 완료 후 재테스트를 수행하겠습니다.

**검증 항목**:
1. 온보딩 페이지로 직접 접근 가능한지 확인
2. 모든 E2E 테스트 통과 확인
3. 실제 사용자 플로우 정상 동작 확인

---

## 📋 진행 상황

- [x] 버그 발견 및 리포트 작성
- [x] PM 요구사항 확인
- [ ] FE Engineer 수정 구현
- [ ] QA 재테스트
- [ ] 모든 테스트 통과 확인

---

## 📝 참고 사항

- 실제 사용자 플로우는 OAuth 콜백 후 온보딩 페이지로 이동하므로 문제 없음
- E2E 테스트 환경에서만 발생하는 문제
- 테스트 가능성을 높이기 위한 개선 필요

