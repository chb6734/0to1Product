# FE Engineer 구현 작업 시작

**참여자**: Sam FE Engineer  
**작성 일시**: 2024년  
**목적**: 테스트 코드를 GREEN 상태로 만들기 위한 구현 작업

---

## 작업 계획

FE TEST가 작성한 테스트 코드를 분석하여 필요한 기능을 구현하겠습니다.

**작성된 테스트:**
1. ✅ 데모 모드 유틸리티 테스트 (`src/shared/utils/__tests__/demoMode.test.ts`) - 이미 구현됨
2. ✅ 기본 플랫폼 설정 테스트 (`src/domains/auth/__tests__/defaultPlatform.test.ts`) - 이미 구현됨
3. ❌ 편지 생성 플로우 통합 테스트 (`src/domains/letter/__tests__/letter-creation-flow-v4.integration.test.tsx`) - 구현 필요

**구현 필요 사항:**
1. 편지 생성 페이지에 데모 모드 지원 추가
2. 완성 모달 구현 (Step 2 대체)
3. 온보딩 페이지에 기본 플랫폼 설정 추가
4. 편지 상세 페이지에 기본 플랫폼 자동 사용 추가

---

## 1단계: 테스트 실행 및 실패 확인

먼저 테스트를 실행하여 어떤 테스트가 실패하는지 확인하겠습니다.

---

## 2단계: PM과의 협업 - 요구사항 확인

### 💻 FE Engineer: PM에게 요구사항 확인

안녕하세요, PM님. FE TEST가 작성한 테스트 코드를 분석했습니다. 편지 생성 페이지에 데모 모드와 완성 모달을 구현해야 하는데, 몇 가지 확인이 필요합니다:

**1. 데모 모드 UI:**
- 데모 모드일 때 상단에 "데모 모드" 배지를 표시해야 하는데, 어떤 스타일로 표시하면 될까요?
- "저장하려면 로그인이 필요합니다" 안내 메시지도 표시해야 할까요?

**2. 완성 모달:**
- PRD v4에 따르면 Step 2를 완성 모달로 대체한다고 되어 있는데, 모달이 열릴 때 배경이 어두워지는 오버레이가 필요한가요?
- 데모 모드일 때와 로그인 사용자일 때 버튼이 다르게 표시되어야 하는데, 정확한 버튼 텍스트를 확인해주세요.

**3. 곡 검색:**
- 곡 검색 API는 아직 구현되지 않았는데, MSW로 모킹하여 진행하면 될까요?
- 검색 결과에서 "추가" 버튼을 클릭하면 useLetter 훅의 addTrack을 호출하면 될까요?

### 🧭 PM: 요구사항 안내

안녕하세요, FE Engineer님. 좋은 질문들입니다.

**1. 데모 모드 UI:**
- "데모 모드" 배지는 상단 헤더 아래에 작은 배지 형태로 표시하면 됩니다 (예: 노란색 배경, 검은색 텍스트)
- "저장하려면 로그인이 필요합니다" 안내 메시지는 배지 옆에 작은 텍스트로 표시하면 됩니다

**2. 완성 모달:**
- 네, 모달이 열릴 때 배경이 어두워지는 오버레이가 필요합니다
- 버튼 텍스트:
  - 데모 모드: "영구 저장하려면 로그인하기" (주요 버튼), "계속 만들기" (보조 버튼)
  - 로그인 사용자: "수정하기" (보조 버튼), "완료" (주요 버튼)

**3. 곡 검색:**
- 네, MSW로 모킹하여 진행하면 됩니다
- 검색 결과에서 "추가" 버튼을 클릭하면 useLetter 훅의 addTrack을 호출하면 됩니다

### 💻 FE Engineer: 구현 시작

이해했습니다, PM님. 이제 구현을 시작하겠습니다.

---

## 3단계: 구현 완료

### 구현된 기능

**1. 편지 생성 페이지 개선:**
- ✅ 데모 모드 지원 추가 (URL 파라미터 확인, 배지 표시)
- ✅ 완성 모달 구현 (Step 2 대체, 모달 형태)
- ✅ 곡 검색 기능 구현 (debounce 300ms, MSW 연동)
- ✅ useLetter 훅 연동 (곡 추가/삭제, 메시지 작성)
- ✅ 데모 모드 편지 데이터 로컬 스토리지 저장
- ✅ 완성 모달에서 링크 복사 기능

**2. 랜딩 페이지 개선:**
- ✅ "로그인 없이 체험하기" 버튼 추가 (`/create?demo=true`)

**3. 온보딩 페이지 개선:**
- ✅ 기본 플랫폼 설정 UI 추가 (드롭다운)
- ✅ 기본 플랫폼 설정 API 연동

**4. useAuth 훅 개선:**
- ✅ User 인터페이스에 `defaultPlatform` 필드 추가

**5. useDefaultPlatform 훅 개선:**
- ✅ 타입 안정성 개선
- ✅ API 응답 처리 개선

### 다음 단계

테스트를 실행하여 GREEN 상태 확인이 필요합니다.

